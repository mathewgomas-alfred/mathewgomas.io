.. meta::
    :description:
        A matrix of all automated builds for Krtia

.. metadata-placeholder

    :authors:
        - Dmitry Kazakov <dimula73@gmail.com>
    :license: GNU free documentation license 1.3 or later.

.. _automated_krita_builds_on_ci_matrix:

===================================
Automated Krita builds on CI matrix
===================================

Android
~~~~~~~

+-----------------------------------------------------------------------+---------------------+-----------------------+-------------------------+
|                                                                       |       Release       |        Nightly        |          CI/MR          |
+=======================================================================+=====================+=======================+=========================+
| ``KRITACI_ANDROID_RELEASE_MODE``                                      | 1                   | 0                     | 0                       |
|                                                                       |                     |                       |                         |
| disables debug-signature and (presumably) strips some assets          |                     |                       |                         |
+-----------------------------------------------------------------------+---------------------+-----------------------+-------------------------+
| ``ANDROIDDEPLOYQT_EXTRA_ARGS``                                        | ``--release``       | none                  | none                    |
|                                                                       |                     |                       |                         |
| (is set by ``KRITACI_ANDROID_RELEASE_MODE``)                          |                     |                       |                         |
+-----------------------------------------------------------------------+---------------------+-----------------------+-------------------------+
| packageId                                                             | ``org.krita``       | ``org.krita.nightly`` | ``org.krita.debug``     |
+-----------------------------------------------------------------------+---------------------+-----------------------+-------------------------+
| Signed by                                                             | Krita Foundation    | KDE e.V.              | default debug signature |
|                                                                       |                     |                       |                         |
|                                                                       | (manually by Halla) | (by signing service)  |                         |
+-----------------------------------------------------------------------+---------------------+-----------------------+-------------------------+
| ``BUILD_TYPE``                                                        | Release             | Release               | Release                 |
+-----------------------------------------------------------------------+---------------------+-----------------------+-------------------------+
| ``HIDE_SAFE_ASSERTS``                                                 | ON                  | OFF                   | OFF                     |
+-----------------------------------------------------------------------+---------------------+-----------------------+-------------------------+
| ``BUILD_TESTING``                                                     | OFF                 | ON                    | ON                      |
+-----------------------------------------------------------------------+---------------------+-----------------------+-------------------------+
| Run the tests                                                         | OFF                 | OFF                   | OFF                     |
|                                                                       |                     |                       |                         |
| Tests are skipped either by ``--only-build``                          |                     |                       |                         |
| option or ``KDECI_ONLY_BUILD`` variable                               |                     |                       |                         |
+-----------------------------------------------------------------------+---------------------+-----------------------+-------------------------+
| Upload to `ci-builds <https://cdn.kde.org/ci-builds/graphics/krita>`_ | OFF                 | ON                    | OFF                     |
+-----------------------------------------------------------------------+---------------------+-----------------------+-------------------------+
| Job is triggered on                                                   | manually on tags    | nightly               | manually                |
+-----------------------------------------------------------------------+---------------------+-----------------------+-------------------------+

Linux
~~~~~

+-----------------------------------------------------------------------+---------------------+----------------------------------+-------------------------------------+
|                                                                       |       Release       |             Nightly              |                CI/MR                |
+=======================================================================+=====================+==================================+=====================================+
| Signed by                                                             | Krita Foundation    | (**to be implemented**,          | none                                |
|                                                                       | (manually by Halla) | by KDE e.V.)                     |                                     |
+-----------------------------------------------------------------------+---------------------+----------------------------------+-------------------------------------+
| BUILD_TYPE                                                            | Release             | Release                          | Release                             |
| (appimages don't support debug symbols)                               |                     |                                  |                                     |
+-----------------------------------------------------------------------+---------------------+----------------------------------+-------------------------------------+
| HIDE_SAFE_ASSERTS                                                     | ON                  | OFF                              | OFF                                 |
+-----------------------------------------------------------------------+---------------------+----------------------------------+-------------------------------------+
| BUILD_TESTING                                                         | OFF                 | OFF                              | ON                                  |
+-----------------------------------------------------------------------+---------------------+----------------------------------+-------------------------------------+
| Run the tests                                                         | OFF                 | OFF                              | ON                                  |
|                                                                       |                     |                                  |                                     |
| Tests are skipped either by ``--only-build``                          |                     | we run tests for every commit,   |                                     |
| option or ``KDECI_ONLY_BUILD`` variable                               |                     | no need to run them in nightlies |                                     |
+-----------------------------------------------------------------------+---------------------+----------------------------------+-------------------------------------+
| Upload to `ci-builds <https://cdn.kde.org/ci-builds/graphics/krita>`_ | OFF                 | ON                               | OFF                                 |
+-----------------------------------------------------------------------+---------------------+----------------------------------+-------------------------------------+
| Job is triggered on                                                   | manually on tags    | nightly                          | for all commits in branches and MRs |
+-----------------------------------------------------------------------+---------------------+----------------------------------+-------------------------------------+

Windows
~~~~~~~

+-----------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------+--------------------------------------------------------+------------------------------------------------------+
|                                                                       |                             Release                              |             Nightly              |                 Protected branches CI                  |                      CI for MRs                      |
+=======================================================================+==================================================================+==================================+========================================================+======================================================+
| Signed by                                                             | * .exe --- by KDE e.V, using signing service                     | only .exe files are signed,      | only .exe files are signed,                            | no signature for unprotected branches                |
|                                                                       | * .msix --- by Krita Foundation, automatically via Windows Store | by KDE e.v.                      | by KDE e.v.                                            |                                                      |
+-----------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------+--------------------------------------------------------+------------------------------------------------------+
| BUILD_TYPE                                                            | RelWithDebInfo                                                   | RelWithDebInfo                   | Release                                                | Release                                              |
+-----------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------+--------------------------------------------------------+------------------------------------------------------+
| SKIP_DEBUG_PACKAGE                                                    | OFF                                                              | OFF                              | ON                                                     | ON                                                   |
|                                                                       |                                                                  |                                  |                                                        |                                                      |
|                                                                       |                                                                  |                                  | (too expensive to build debug                          | (too expensive to build debug                        |
|                                                                       |                                                                  |                                  | package for every commit)                              | package for every commit)                            |
+-----------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------+--------------------------------------------------------+------------------------------------------------------+
| BUILD_INSTALLERS                                                      | ON                                                               | ON                               | OFF                                                    | OFF                                                  |
|                                                                       |                                                                  |                                  |                                                        |                                                      |
|                                                                       |                                                                  |                                  | (too expensive to build installers for every commit)qp | (too expensive to build installers for every commit) |
+-----------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------+--------------------------------------------------------+------------------------------------------------------+
| HIDE_SAFE_ASSERTS                                                     | ON                                                               | OFF                              | OFF                                                    | OFF                                                  |
+-----------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------+--------------------------------------------------------+------------------------------------------------------+
| BUILD_TESTING                                                         | OFF                                                              | OFF                              | ON                                                     | ON                                                   |
+-----------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------+--------------------------------------------------------+------------------------------------------------------+
| Run the tests                                                         | OFF                                                              | OFF                              | ON                                                     | ON                                                   |
|                                                                       |                                                                  |                                  |                                                        |                                                      |
| Tests are skipped either by ``--only-build``                          |                                                                  | we run tests for every commit,   |                                                        |                                                      |
| option or ``KDECI_ONLY_BUILD`` variable                               |                                                                  | no need to run them in nightlies |                                                        |                                                      |
+-----------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------+--------------------------------------------------------+------------------------------------------------------+
| Upload to `ci-builds <https://cdn.kde.org/ci-builds/graphics/krita>`_ | OFF                                                              | ON                               | OFF                                                    | OFF                                                  |
+-----------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------+--------------------------------------------------------+------------------------------------------------------+
| Job is triggered on:                                                  | manually on tags                                                 | nightly                          | for every commit                                       | for every commit                                     |
+-----------------------------------------------------------------------+------------------------------------------------------------------+----------------------------------+--------------------------------------------------------+------------------------------------------------------+

MacOS
~~~~~~~

+-----------------------------------------------------------------------+--------------------------------------+-------------------------------------------+-----------------------+---------------------------------------+
|                                                                       |               Release                |                  Nightly                  | Protected branches CI |              CI for MRs               |
+=======================================================================+======================================+===========================================+=======================+=======================================+
| Signed by                                                             | * Standalone pacakges: by KDE e.V.   | by KDE e.V.                               | by KDE e.V.           | no signature for unprotected branches |
|                                                                       | * MacOS Store: by Halla, manually    |                                           |                       |                                       |
+-----------------------------------------------------------------------+--------------------------------------+-------------------------------------------+-----------------------+---------------------------------------+
| packageId                                                             | * Standalone pacakges: ``org.krita`` | ``org.krita``                             | ``org.krita``         | ``org.krita``                         |
|                                                                       | * MacOS Store: ``org.kde.krita``     |                                           |                       |                                       |
+-----------------------------------------------------------------------+--------------------------------------+-------------------------------------------+-----------------------+---------------------------------------+
| BUILD_TYPE                                                            | Release                              | Release                                   | Release               | Release                               |
+-----------------------------------------------------------------------+--------------------------------------+-------------------------------------------+-----------------------+---------------------------------------+
| BUILD_TESTING                                                         | OFF                                  | ON (since there are no per-commit builds) | ON                    | ON                                    |
+-----------------------------------------------------------------------+--------------------------------------+-------------------------------------------+-----------------------+---------------------------------------+
| Run the tests                                                         | OFF                                  | ON (since there are no per-commit builds) | ON                    | ON                                    |
|                                                                       |                                      |                                           |                       |                                       |
| Tests are skipped either by ``--only-build``                          |                                      |                                           |                       |                                       |
| option or ``KDECI_ONLY_BUILD`` variable                               |                                      |                                           |                       |                                       |
+-----------------------------------------------------------------------+--------------------------------------+-------------------------------------------+-----------------------+---------------------------------------+
| Upload to `ci-builds <https://cdn.kde.org/ci-builds/graphics/krita>`_ | OFF                                  | ON                                        | OFF                   | OFF                                   |
+-----------------------------------------------------------------------+--------------------------------------+-------------------------------------------+-----------------------+---------------------------------------+
| Job is triggered on:                                                  | manually on tags                     | nightly                                   | manually              | manually                              |
+-----------------------------------------------------------------------+--------------------------------------+-------------------------------------------+-----------------------+---------------------------------------+
